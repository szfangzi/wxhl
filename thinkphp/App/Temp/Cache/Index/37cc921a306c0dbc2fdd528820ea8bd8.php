<?php if (!defined('THINK_PATH')) exit();?><!doctype html>
<html>
<head>
<meta charset="utf-8">
<title>如影随形黑色个人博客HTML5模板 - 源码之家</title>
<meta name="keywords" content="" />
<meta name="description" content="" />
<link href="__PUBLIC__/css/base.css" rel="stylesheet">
<link href="__PUBLIC__/css/media.css" rel="stylesheet">
<meta name="viewport" content="width=device-width, minimum-scale=1.0, maximum-scale=1.0">
<!--[if lt IE 9]>
<script src="__PUBLIC__/js/modernizr.js"></script>
<![endif]-->
</head>
<body>
<div class="ibody">
  <header>
    <h1>如影随形</h1>
    <h2>影子是一个会撒谎的精灵，它在虚空中流浪和等待被发现之间;在存在与不存在之间....</h2>
    <div class="logo"><a href="/"></a></div>
    <nav id="topnav"><a href="<?php echo U('Index/Index/index');?>">首页</a><a href="<?php echo U('Index/Index/about');?>">关于我</a><a href="<?php echo U('Index/List/index');?>">慢生活</a></nav>
  </header>


<link href="__PUBLIC__/css/style.css" rel="stylesheet">
<article>
  <h2 class="about_h">您现在的位置是：<a href="<?php echo U('Index/Index/index');?>">首页</a>> <span>慢生活</span></h2>
  <div id="bloglist" class="bloglist"></div>
  <div id="page" class="page"></div>

</article>

<aside>
    <div class="rnav">
      <li class="rnav1 "><a href="/">日记</a></li>
      <li class="rnav2 "><a href="/">欣赏</a></li>
      <li class="rnav3 "><a href="/">程序人生</a></li>
      <li class="rnav4 "><a href="/">经典语录</a></li>
    </div>
    <div class="ph_news">
      <h2>
        <p>点击排行</p>
      </h2>
      <ul class="ph_n">
        <li><span class="num1">1</span><a href="/">ÓÐÒ»ÖÖË¼Äî£¬ÊÇµ­µ­µÄÐÒ¸£,Ò»¸öÐÄÇéÒ»ÐÐÎÄ×Ö</a></li>
        <li><span class="num2">2</span><a href="/">ÀøÖ¾ÈËÉú-Òª×öÒ»¸öäìÈ÷µÄÅ®ÈË</a></li>
        <li><span class="num3">3</span><a href="/">Å®º¢¶¼ÓÐÀËÂþµÄÐ¡Çé»³¡ª¡ªÀËÂþµÄÇó»é´Ê</a></li>
        <li><span>4</span><a href="/">GreenÂÌÉ«Ð¡ÇåÐÂµÄÏÄÌì-¸öÈË²©¿ÍÄ£°å</a></li>
        <li><span>5</span><a href="/">Å®ÉúÇåÐÂ¸öÈË²©¿ÍÍøÕ¾Ä£°å</a></li>
        <li><span>6</span><a href="/">Wedding-»éÀñÖ÷Ìâ¡¢ÇéÈË½ÚÍøÕ¾Ä£°å</a></li>
        <li><span>7</span><a href="/">Column ÈýÀ¸²¼¾Ö ¸öÈËÍøÕ¾Ä£°å</a></li>
        <li><span>8</span><a href="/">Ê±¼äÖóÓê-¸öÈËÍøÕ¾Ä£°å</a></li>
        <li><span>9</span><a href="/">»¨ÆøÏ®ÈËÊÇ¾ÆÏã¡ª¸öÈËÍøÕ¾Ä£°å</a></li>
      </ul>
      <h2>
        <p>栏目推荐</p>
      </h2>
      <ul>
        <li><a href="/">ÓÐÒ»ÖÖË¼Äî£¬ÊÇµ­µ­µÄÐÒ¸£,Ò»¸öÐÄÇéÒ»ÐÐÎÄ×Ö</a></li>
        <li><a href="/">ÀøÖ¾ÈËÉú-Òª×öÒ»¸öäìÈ÷µÄÅ®ÈË</a></li>
        <li><a href="/">Å®º¢¶¼ÓÐÀËÂþµÄÐ¡Çé»³¡ª¡ªÀËÂþµÄÇó»é´Ê</a></li>
        <li><a href="/">GreenÂÌÉ«Ð¡ÇåÐÂµÄÏÄÌì-¸öÈË²©¿ÍÄ£°å</a></li>
        <li><a href="/">Å®ÉúÇåÐÂ¸öÈË²©¿ÍÍøÕ¾Ä£°å</a></li>
        <li><a href="/">Wedding-»éÀñÖ÷Ìâ¡¢ÇéÈË½ÚÍøÕ¾Ä£°å</a></li>
        <li><a href="/">Column ÈýÀ¸²¼¾Ö ¸öÈËÍøÕ¾Ä£°å</a></li>
        <li><a href="/">Ê±¼äÖóÓê-¸öÈËÍøÕ¾Ä£°å</a></li>
        <li><a href="/">»¨ÆøÏ®ÈËÊÇ¾ÆÏã¡ª¸öÈËÍøÕ¾Ä£°å</a></li>
      </ul>
      <h2>
        <p>最新评论</p>
      </h2>
      <ul class="pl_n">
        <dl>
          <dt><img src="__PUBLIC__/images/s8.jpg"> </dt>
          <dt> </dt>
          <dd>DanceSmile
            <time>49·ÖÖÓÇ°</time>
          </dd>
          <dd><a href="/">ÎÄÕÂ·Ç³£ÏêÏ¸£¬ÎÒºÜÏ²»¶.Ç°¶ËµÄ¹¤³ÌÊ¦ºÜÉÙ£¬ÎÒ¼ÇµÃ¼¸ÄêÇ°yahoo»¨¸ßÐ½ÕÐÆ¸Ç°¶ËÒ²ÕÐ²»µ½</a></dd>
        </dl>
        <dl>
          <dt><img src="__PUBLIC__/images/s7.jpg"> </dt>
          <dt> </dt>
          <dd>yisa
            <time>2Ð¡Ê±Ç°</time>
          </dd>
          <dd><a href="/">ÎÒÊÖ»úÀïÃæÒ²ÓÐÕâÑùÒ»¸öºÅÂë´æÔÚ</a></dd>
        </dl>
        <dl>
          <dt><img src="__PUBLIC__/images/s6.jpg"> </dt>
          <dt> </dt>
          <dd>Ð¡ÁÖ²©¿Í
            <time>8ÔÂ7ÈÕ</time>
          </dd>
          <dd><a href="/">²©¿ÍÉ«²Ê·á¸»£¬ºÜÊÇºÃ¿´</a></dd>
        </dl>
        <dl>
          <dt><img src="__PUBLIC__/images/003.jpg"> </dt>
          <dt> </dt>
          <dd>DanceSmile
            <time>49·ÖÖÓÇ°</time>
          </dd>
          <dd><a href="/">ÎÄÕÂ·Ç³£ÏêÏ¸£¬ÎÒºÜÏ²»¶.Ç°¶ËµÄ¹¤³ÌÊ¦ºÜÉÙ£¬ÎÒ¼ÇµÃ¼¸ÄêÇ°yahoo»¨¸ßÐ½ÕÐÆ¸Ç°¶ËÒ²ÕÐ²»µ½</a></dd>
        </dl>
        <dl>
          <dt><img src="__PUBLIC__/images/002.jpg"> </dt>
          <dt> </dt>
          <dd>yisa
            <time>2Ð¡Ê±Ç°</time>
          </dd>
          <dd><a href="/">ÎÒÊÖ»úÀïÃæÒ²ÓÐÕâÑùÒ»¸öºÅÂë´æÔÚ</a></dd>
        </dl>
      </ul>
      <h2>
        <p>最近访客</p>
        <ul>
          <img src="__PUBLIC__/images/vis.jpg">
        </ul>
      </h2>
    </div>
    <div class="copyright">
      <ul>
        <p> Design by <a href="/">DanceSmile</a></p>
        <p>蜀ICP备11002373号-1</p>
        </p>
      </ul>
    </div>
  </aside>
	
  	<div class="clear"></div>
  	<script src="__PUBLIC__/js/jquery.min.js"></script>
  	<script src="__PUBLIC__/js/ejs.min.js"></script>
  	<script src="__PUBLIC__/js/common.js"></script>
  	<script src="__PUBLIC__/js/silder.js"></script>
  	
<script id="listTmpl" type="text/template">
<% if(data.length){ %>
<% data.forEach(function(v,k){ %>
<div class="newblog">
  <ul>
    <h3><a href="<%=detailUrl%>/id/<%=v.id%>" target="_blank"><%=v.post_title%></a></h3>
    <div class="autor"><span>作者:<%=v.post_author%></span><span>分类<a href="/"><!-- <%=v.post_author%> --></a></span><span>浏览（<a href="/"><%=v.view_count%></a>）</span><span>评论（<a href="/"><%=v.comment_count%></a>）</span></div>
    <p><%=v.post_content%>sssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssss...<a href="<%=detailUrl%>/id/<%=v.id%>" target="_blank" class="readmore">查看全文</a></p>
  </ul>
  <figure><img src="images/001.jpg" ></figure>
  <div class="dateview"><%=Util.toDate(v.post_date*1000)%></div>
</div>
<% }); %>
<% } %>
</script>
<script id="pageTmpl" type="text/template">
<% if(data){ %>
<span title="Total record">共 <b><%=data.totalRows%></b> 条数据</span> 
<% if(data.nowPage > 1){ %>
<a href="javascript:;" id="firstPage">首页</a>
<a href="javascript:;" id="prePage">上页</a>
<% } %>
<span id="numPage">
<% 
  var maxShowPage = 0,
      minShowPage = 0;
  if(data.nowPage <= 3){
    if(data.totalPages <= 5){
      maxShowPage = data.totalPages;
    }else{
      maxShowPage = 5;
    }
    minShowPage = 1;
  }else{
    maxShowPage = (data.nowPage + 2) > data.totalPages ? data.totalPages : (data.nowPage + 2);
    if(data.totalPages - data.nowPage < 2){
      minShowPage = data.totalPages - 4;
    }else{
      minShowPage = data.nowPage - 2;
    }
  }

%>
 
<% for(var i = minShowPage; i <= maxShowPage; i++){ %>
    <a href="javascript:;" <% if(i == data.nowPage){ %> class="on" <% } %> p="<%=i%>"><%=i%></a>

<% } %>
</span>

<% if(data.nowPage < data.totalPages){  %>
<a href="javascript:;" id="nextPage">下页</a>
<a href="javascript:;" id="lastPage">尾页</a>
<% } %>

<% } %>
</script>


  <script type="text/javascript">

  var info = JSON.parse('<?php echo ($info); ?>');
  var page = info.page,
      nowPage = page.nowPage,
      totalPages = page.totalPages,
      detailUrl = "<?php echo U('Index/List/detail');?>";

  getList(info);

  function refreshPageData(newPage){
    page = newPage;
    nowPage = page.nowPage,
    totalPages = page.totalPages;
  }

  function getList(data){
    
    var page = data.page,
        posts = data.posts;

    refreshPageData(page);

    var listTmpl = document.getElementById('listTmpl').innerHTML;
    var listHtml = ejs.render(listTmpl, { data: posts });
    $('#bloglist').html(listHtml);

    var pageTmpl = document.getElementById('pageTmpl').innerHTML;
    var pageHtml = ejs.render(pageTmpl, { data: page });
    $('#page').html(pageHtml);

    $('body,html').animate({ scrollTop: 0 }, 800);
  }

  $('#page').on('click', '#firstPage', function(){
    $.get("<?php echo U('Index/List/index');?>",{p:1},function(data){
      if(data.status==1){
        getList(data.info);
      }
    });
  }).on('click', '#lastPage', function(){
    $.get("<?php echo U('Index/List/index');?>",{p:totalPages},function(data){
      if(data.status==1){
        getList(data.info);
      }
    });
  }).on('click', '#prePage', function(){
    if(nowPage > 1){
      var newPage = nowPage - 1;  
    }
    $.get("<?php echo U('Index/List/index');?>",{p:newPage},function(data){
      if(data.status==1){
        getList(data.info);
      }
    });
  }).on('click', '#nextPage', function(){
    if(nowPage < totalPages){
      var newPage = nowPage + 1;
    }
    $.get("<?php echo U('Index/List/index');?>",{p:newPage},function(data){
      if(data.status==1){
        getList(data.info);
      }
    });
  }).on('click', '#numPage a', function(){
    var $this = $(this);
    $.get("<?php echo U('Index/List/index');?>",{p:$this.attr('p')},function(data){
      if(data.status==1){
        getList(data.info);
      }
      
    });
  });
  
  </script>

</div>
</body>
</html>